"0",""
"0","#sort in long format"
"0","df_long <- df_results %>% "
"0","  pivot_longer(cols = VVD:Vrije.Democratische.Partij..VDP., names_to = ""party"", values_to = ""votes"") %>%"
"0","  select(regio =RegioNaam, code = RegioCode,party, votes) %>% "
"0","  filter(!is.na(votes)) %>% "
"0","  group_by(code) %>% "
"0","  mutate(total = sum(votes)) %>% "
"0","  slice_max(votes)"
"0",""
"0","df_long$percentage <- (df_long$votes/df_long$total)*100"
"0","df_long$percentage <- round(df_long$percentage,1)"
"0",""
"0","df_long$code <- gsub(""G"","""",df_long$code)"
"0",""
"0","#fix the names"
"0","df_long$party <- gsub(""Partij.van.de.Arbeid..P.v.d.A.."",""PvdA"",df_long$party)"
"0","df_long$party <- gsub(""Democraten.66..D66."",""D66"",df_long$party)"
"0","df_long$party <- gsub(""X50PLUS"",""Partij 50PLUS"",df_long$party)"
"0","df_long$party <- gsub(""Forum.voor.Democratie"",""FvD"",df_long$party)"
"0","df_long$party <- gsub(""Forum.voor.Democratie"",""FvD"",df_long$party)"
"0","df_long$party <- gsub(""SP..Socialistische.Partij."",""SP"",df_long$party)"
"0","df_long$party <- gsub(""PVV..Partij.voor.de.Vrijheid."",""PVV"",df_long$party)"
"0","df_long$party <- gsub(""Staatkundig.Gereformeerde.Partij..SGP."",""SGP"",df_long$party)"
"0","df_long$party <- gsub(""Partij.voor.de.Dieren"",""PvdD"",df_long$party)"
"0","df_long$party <- as.factor(df_long$party)"
"0","df_long$regio <- gsub(""'"","""",df_long$regio)"
"0","df_long$regio <- gsub(""-"","" "",df_long$regio)"
"0","df_long <- left_join(df_long,colourscheme)"
"2","Joining, by = ""party""
"
"0","fptp_results <- table(df_long$party) %>% as.data.frame()"
"0","colnames(fptp_results) <- c(""party"",""seats"")"
"0","fptp_results <- left_join(fptp_results,colourscheme)"
"2","Joining, by = ""party""
"
"0","ggplot(fptp_results) +"
"0","  ggpol::geom_parliament(aes(seats = seats, fill = party),color=""black"") + "
"0","  #highlight the party in control of the House with a black line"
"0","  scale_fill_manual(values = fptp_results$colour, "
"0","                    labels = fptp_results$party)+"
"0","  coord_fixed()+"
"0","  theme_void()"
"0",""
