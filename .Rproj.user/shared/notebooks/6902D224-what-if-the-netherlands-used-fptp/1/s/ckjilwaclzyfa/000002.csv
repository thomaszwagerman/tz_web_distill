"0","#sort in long format"
"0","df_pie <- df_results %>% "
"0","  pivot_longer(cols = VVD:Vrije.Democratische.Partij..VDP., names_to = ""party"", values_to = ""votes"") %>%"
"0","  select(regio =RegioNaam, code = RegioCode,party, votes) %>% "
"0","  filter(!is.na(votes)) %>% "
"0","  group_by(code) %>% "
"0","  mutate(total = sum(votes)) "
"0",""
"0","df_pie$percentage <- (df_pie$votes/df_pie$total)*100"
"0","df_pie$percentage <- round(df_pie$percentage,1)"
"0","# "
"0","df_pie$party <- gsub(""Partij.van.de.Arbeid..P.v.d.A.."",""PvdA"",df_pie$party)"
"0","df_pie$party <- gsub(""Democraten.66..D66."",""D66"",df_pie$party)"
"0","df_pie$party <- gsub(""X50PLUS"",""Partij 50PLUS"",df_pie$party)"
"0","df_pie$party <- gsub(""Forum.voor.Democratie"",""FvD"",df_pie$party)"
"0","df_pie$party <- gsub(""Forum.voor.Democratie"",""FvD"",df_pie$party)"
"0","df_pie$party <- gsub(""SP..Socialistische.Partij."",""SP"",df_pie$party)"
"0","df_pie$party <- gsub(""PVV..Partij.voor.de.Vrijheid."",""PVV"",df_pie$party)"
"0","df_pie$party <- gsub(""Staatkundig.Gereformeerde.Partij..SGP."",""SGP"",df_pie$party)"
"0","df_pie$party <- gsub(""Partij.voor.de.Dieren"",""PvdD"",df_pie$party)"
"0","df_pie$party <- as.factor(df_pie$party)"
"0",""
"0","df_pie$party <- as.character(df_pie$party)"
"0","df_pie$percentage <- as.numeric(df_pie$percentage)"
"0",""
"0","pie_plot_list <- lapply(unique(df_pie$regio), function(i) {"
"0","  regio_df <- df_pie %>% "
"0","    filter(regio == i) %>%"
"0","    dplyr::ungroup() %>% "
"0","    select(party,percentage) %>%"
"0","    filter(percentage >0.1) %>% "
"0","    as.data.frame()"
"0","  regio_df <- regio_df[order(regio_df$percentage,decreasing = T),]"
"0","  regio_df <- left_join(regio_df,colourscheme)"
"0","  "
"0","  ggplot(regio_df) +"
"0","    geom_bar(aes(x = """", y = percentage, fill = party),"
"0","             stat = ""identity"", colour = ""black"", width =1) +"
"0","    #geom_text(aes(x = """", y = pct, label = percent(pct)), position = position_stack(vjust = 0.5))+"
"0","    coord_polar(""y"", start = 0) +"
"0","    labs(x = NULL, y = NULL, fill = NULL, "
"0","         title = paste(""Verkiezingsuitslag"",i)) +"
"0","    theme_classic()+"
"0","    scale_fill_manual(values = regio_df$colour, "
"0","                      limits = regio_df$party)+ "
"0","    theme(axis.line = element_blank(),"
"0","          axis.text = element_blank(),"
"0","          axis.ticks = element_blank(),"
"0","          plot.title = element_text(hjust = 0.5, color = ""black""))"
"0","})"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"2","Joining, by = ""party""
"
"0","#link to spatial"
"0","shp_fptp <- left_join(shp_gemeentes, df_long, by = c(""Code""=""code"")) %>% "
"0","  select(-FID,Code,-Gemeentena,-Gemeenteco)"
"0","shp_fptp <- shp_fptp %>% "
"0","  filter(percentage >0.1)"
"0",""
"0","mapview(shp_fptp,"
"0","                 zcol = ""party"","
"0","                 col.regions = shp_fptp$colour,"
"0","                 popup = popupGraph(pie_plot_list))"
